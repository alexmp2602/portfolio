---
const { title, slug, demo, image } = Astro.props;
const hasIframe = !!demo;
const demoId = `lab-${slug}`;
---

<article
  class="glass-card rounded-2xl overflow-hidden shadow-md transition-transform duration-300 hover:scale-[1.015] hover:shadow-xl motion-safe:animate-fade-slide-up"
  role="article"
  aria-labelledby={demoId}
  data-reveal
>
  <a
    href={`/lab/${slug}`}
    class="block h-full"
    aria-label={`Ver demo: ${title}`}
  >
    <div class="p-5">
      <h3 id={demoId} class="text-xl font-semibold text-surface mb-3">
        {title}
      </h3>
    </div>

    {
      hasIframe ? (
        <iframe
          src={demo}
          title={`Vista previa animada de ${title}`}
          loading="lazy"
          sandbox="allow-scripts allow-same-origin allow-popups"
          class="w-full h-48 border-t border-black/5 dark:border-white/10 transition duration-300 md:pointer-events-auto md:opacity-100 md:filter-none pointer-events-none opacity-70 grayscale-[30%] rounded-b-2xl"
        />
      ) : (
        <img
          src={image ?? "/assets/lab/default.webp"}
          alt={`Vista previa de ${title}`}
          loading="lazy"
          decoding="async"
          width="640"
          height="270"
          class="w-full h-48 object-cover border-t border-black/5 dark:border-white/10 rounded-b-2xl"
        />
      )
    }
  </a>
</article>
