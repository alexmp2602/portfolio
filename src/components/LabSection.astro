---
import LabCard from "./LabCard.astro";
import { experiments } from "../data/experiments";

type Experiment = (typeof experiments)[number];

const gsapDemo: Experiment | undefined =
  experiments.find((e) => e.slug === "gsap") ??
  experiments.find((e) => /gsap/i.test(e.title));

const gsapImg = gsapDemo?.image ?? "/assets/lab/gsap-cover.webp";

const sigj = experiments.find((e) => e.slug === "sigj");
const saae = experiments.find((e) => e.slug === "saae");
const systemsImg = sigj?.image ?? saae?.image ?? "/assets/lab/default.webp";

const gsapDesc =
  gsapDemo?.description ??
  "Colección curada de micro-animaciones y transiciones con GSAP.";

const systemsDesc =
  "Exploración de sistemas y herramientas internas. Detalles, pantallas y decisiones de implementación.";
---

<section
  id="laboratorio"
  class="page-bg py-28 px-6 md:px-12 section-lazy"
  aria-labelledby="lab-title"
>
  <div class="max-w-7xl mx-auto">
    <h2
      id="lab-title"
      class="text-4xl md:text-5xl font-extrabold text-center mb-10 text-surface fade-in-up"
    >
      Laboratorio
    </h2>

    <div
      class="glass-box max-w-3xl mx-auto p-8 md:p-10 mb-12 text-center fade-in-up fade-delay-100"
    >
      <p
        class="text-lg md:text-xl text-surface-muted leading-relaxed text-balance"
      >
        Una selección breve para no sobrecargar el home. Entrando a cada card
        podés ver el detalle completo.
      </p>
    </div>

    <ul class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-8">
      {
        gsapDemo && (
          <li class="fade-in-up" data-reveal>
            <LabCard
              slug="gsap"
              title="Animaciones con GSAP"
              description={gsapDesc}
              image={gsapImg}
              imageWebp={gsapDemo.imageWebp}
              imageAvif={gsapDemo.imageAvif}
            />
          </li>
        )
      }

      <li class="fade-in-up" data-reveal>
        <LabCard
          slug="sistemas"
          title="Sistemas"
          description={systemsDesc}
          image={systemsImg}
        />
      </li>
    </ul>
  </div>
</section>
