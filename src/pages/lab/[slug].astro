---
import Layout from "../../layouts/Layout.astro";
import NavbarBack from "../../components/NavbarBack.astro";
import { experiments } from "../../data/experiments";
import { AstroError } from "astro/errors";

export async function getStaticPaths() {
  return experiments.map((exp) => ({ params: { slug: exp.slug } }));
}

const { slug } = Astro.params;
const experiment = experiments.find((exp) => exp.slug === slug);

if (!experiment) {
  throw new AstroError(`Experimento no encontrado: ${slug}`);
}
---

<Layout>
  <NavbarBack />
  <section class="py-20 px-6 md:px-12 max-w-5xl mx-auto" data-reveal>
    <div class="glass-box p-10 rounded-3xl shadow-lg transition-all">
      <h1 class="text-4xl font-extrabold text-dark dark:text-light mb-6">
        {experiment.title}
      </h1>

      {
        experiment.description && (
          <p class="text-lg text-dark dark:text-light leading-relaxed mb-10">
            {experiment.description}
          </p>
        )
      }

      <iframe
        src={experiment.demo}
        class="w-full h-[600px] rounded-xl border border-neutral-300 dark:border-neutral-700"
        loading="lazy"
        title={`Demo interactivo de ${experiment.title}`}
        sandbox="allow-scripts allow-same-origin allow-popups"
        frameborder="0"></iframe>

      <div class="mt-8 text-center">
        <a href="/lab" class="btn-primary inline-block rounded-full">
          ‚Üê Volver al laboratorio
        </a>
      </div>
    </div>
  </section>
</Layout>
